<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azioni PG D&D 5e</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><text y='28' font-size='28' fill='%23333'>F</text></svg>">
    <style>
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:20px;background:#f5f5f5;color:#333}
        .container{max-width:1000px;margin:0 auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,0.1)}
        h1{text-align:center;color:#8B4513;font-size:2.2em;margin-bottom:20px}
        .azioni-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px}
        .azione-gruppo{background:#fafafa;border:2px solid #ddd;border-radius:10px;overflow:hidden}
        .azione-gruppo h2{background:linear-gradient(135deg,#8B4513,#A0522D);color:white;padding:15px;margin:0;font-size:1.4em;text-align:center}
        .lista-azioni{max-height:500px;overflow-y:auto;padding:10px}
        .lista-azioni li{list-style:none;padding:12px;margin:8px 0;border-left:4px solid #8B4513;background:#fff;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,0.1)}
        .nome-azione{font-weight:bold;font-size:1.1em;color:#2c3e50;margin-bottom:5px}
        .dettagli{font-size:0.95em;color:#555;line-height:1.4}
        .dettagli span{display:inline-block;margin-right:15px;margin-bottom:5px;background:#ecf0f1;padding:3px 8px;border-radius:12px;font-size:0.9em}
        nav{text-align:center;margin:30px 0}
        nav a{display:inline-block;padding:12px 25px;background:#8B4513;color:white;text-decoration:none;border-radius:25px;font-weight:bold;box-shadow:0 4px 10px rgba(139,69,19,0.3)}
        nav a:hover{background:#A0522D;transform:translateY(-2px)}
        .loading,.error{text-align:center;padding:40px;font-size:1.2em}
        .loading{color:#8B4513}.error{color:#e74c3c}
        @media (max-width:768px){.azioni-container{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div class="container">
        <h1>üó°Ô∏è Azioni & Incantesimi</h1>
        <div id="azioni" class="azioni-container">
            <div class="loading">Caricamento azioni dal Google Sheet...</div>
        </div>
        <nav>
            <a href="index.html">üè† Scheda Principale</a>
        </nav>
    </div>

    <script>
        // TUO ULTIMO URL MULTICLASSE
        const API_URL = 'https://corsproxy.io/?' + encodeURIComponent('https://script.google.com/macros/s/AKfycbxOQtKEtAFeAyQLgIIgf4o7saBK3ueOu7KCKWP9MuyqFCovrNP7Px5R0Bdnz6Dk-3yeVw/exec');
        
        async function caricaAzioni() {
            const container = document.getElementById('azioni');
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                const azioni = data.azioni || [];
                
                if (!Array.isArray(azioni) || azioni.length === 0) {
                    container.innerHTML = '<div class="error">‚ö†Ô∏è Nessuna azione nel foglio "Azioni". Aggiungi dati!</div>';
                    return;
                }
                
                const gruppi = {'1 action':[],'Bonus Action':[],'Reazione':[],'Altro':[]};
                
                azioni.forEach(azione => {
                    const ct = azione['casting time'] || 'Altro';
                    const gruppo = gruppi[ct] || gruppi.Altro;
                    
                    let dettagli = '';
                    Object.keys(azione).forEach(k => {
                        if (k !== 'nome' && k !== 'casting time' && azione[k]) {
                            dettagli += `<span>${k}: ${azione[k]}</span>`;
                        }
                    });
                    
                    gruppo.push(`
                        <li>
                            <div class="nome-azione">${azione.nome || 'Senza nome'}</div>
                            <div class="dettagli">${dettagli}</div>
                        </li>
                    `);
                });
                
                container.innerHTML = '';
                Object.entries(gruppi).forEach(([tipo,lista]) => {
                    if (lista.length) {
                        const titoli = {
                            '1 action': '‚öîÔ∏è 1 Azione',
                            'Bonus Action': '‚≠ê Azione Bonus', 
                            'Reazione': 'üõ°Ô∏è Reazione',
                            'Altro': 'üìã Altro'
                        };
                        container.innerHTML += `
                            <div class="azione-gruppo">
                                <h2>${titoli[tipo] || tipo}</h2>
                                <ul class="lista-azioni">${lista.join('')}</ul>
                            </div>`;
                    }
                });
                
            } catch(error) {
                container.innerHTML = `
                    <div class="error">
                        ‚ùå Errore: ${error.message}<br>
                        <small><a href="https://script.google.com/macros/s/AKfycbxOQtKEtAFeAyQLgIIgf4o7saBK3ueOu7KCKWP9MuyqFCovrNP7Px5R0Bdnz6Dk-3yeVw/exec" target="_blank">Test API</a></small>
                    </div>`;
            }
        }
        
        window.addEventListener('load', caricaAzioni);
    </script>
</body>
</html>
